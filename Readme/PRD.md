# Product Requirements Document: Stop Being Poor (MVP)

## 1. Introduction

*   **Goal:** To define the functional and non-functional requirements for the Minimum Viable Product (MVP) of the "Stop Being Poor" trading simulation game.
*   **Scope:** This document covers the core gameplay loop, user interface elements, and essential mechanics as outlined in the GDD and implemented in the current codebase. It focuses on delivering the primary user experience.

## 2. User Stories / Features

*   **US01:** As a player, I want to start the game from a main menu screen so that I can initiate a new game session.
*   **US02:** As a player, I want to choose a trader character from a selection screen before starting the trading phase so that I can have a visual identity in the game.
*   **US03:** As a player, I want to see a real-time candlestick chart simulating asset price movement so that I can make trading decisions.
*   **US04:** As a player, I want to be able to open a "Buy" (Long) position based on the current price so that I can profit from price increases.
*   **US05:** As a player, I want to be able to open a "Sell" (Short) position based on the current price so that I can profit from price decreases.
*   **US06:** As a player, I want to adjust the leverage (1x-1000x) applied to my trades *before* entering a position so that I can control my risk and potential reward.
*   **US07:** As a player, I want my entire wallet balance at the time of entry to be used as the position's margin/size so that the stakes are clear and high.
*   **US08:** As a player, I want to see my real-time Profit and Loss (PNL) for any open position displayed clearly so that I know my current trade performance.
*   **US09:** As a player, I want to see my current wallet balance update dynamically based on the real-time PNL of my open position so that I understand my current financial standing.
*   **US10:** As a player, I want to be able to manually close my open position at the current market price so that I can realize profits or cut losses.
*   **US11:** As a player, I want the game to automatically end my session (liquidation) if my losses on an open position equal or exceed my wallet balance at the time I entered the trade, so that the risk of ruin is simulated.
*   **US12:** As a player, I want the game session to end after a fixed time limit (2 minutes) so that there is a clear duration and endpoint for each round.
*   **US13:** As a player, I want to see visual feedback on my trader's status (changing emotion emoji, heart rate monitor, sanity meter) so that the psychological aspect of trading is represented.
*   **US14:** As a player, I want to see a summary screen when the game ends (either by time or liquidation) showing my final balance, total PNL, and trade history, so that I can review my performance.
*   **US15:** As a player, I want to be able to easily start a new game ("Play Again") from the game over screen so that I can quickly retry.

## 3. Functional Requirements

| ID    | Requirement                                                                                                                               | Component(s) Involved                                  | Verification                                                                                                                                                              |
| :---- | :---------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| FR01  | The application shall display a Start Screen upon launch with a "START GAME" button.                                                      | `App.jsx`                                              | Launch app, verify Start Screen is visible.                                                                                                                               |
| FR02  | Clicking "START GAME" shall transition the application state to `CHARACTER_SELECT`.                                                       | `App.jsx`                                              | Click "START GAME", verify Character Select screen appears.                                                                                                               |
| FR03  | The Character Select screen shall display at least 3 distinct character options (Emoji, Name).                                            | `CharacterSelect.jsx`                                  | View Character Select screen, verify 3+ options are shown.                                                                                                                |
| FR04  | Clicking a character option shall transition the application state to `TRADING` and pass the selected character data.                     | `App.jsx`, `CharacterSelect.jsx`                       | Click a character, verify Trading screen appears and header shows selected character.                                                                                     |
| FR05  | The Trading screen shall display the `GameHeader`, `ChartDisplay`, `TradingPanel`, and `TradingActions` components.                       | `InteractiveTradingPreview.jsx`                        | View Trading screen, verify all four main components are rendered.                                                                                                        |
| FR06  | `GameHeader` shall display the correct selected character, wallet balance, total PNL, remaining time (MM:SS), and sanity meter (X/8 + bar). | `GameHeader.jsx`, `InteractiveTradingPreview.jsx`      | Observe header during gameplay, verify all data points are present and update correctly. Check formatting (currency, time). Verify sanity bar reflects numeric value. |
| FR07  | `ChartDisplay` shall render a candlestick chart based on `chartData` updated approximately every second.                                  | `ChartDisplay.jsx`, `InteractiveTradingPreview.jsx`    | Observe chart, verify candles appear and update over time.                                                                                                                |
| FR08  | `ChartDisplay` shall allow scrolling through time using the mouse wheel or navigation buttons (←/→).                                      | `ChartDisplay.jsx`, `InteractiveTradingPreview.jsx`    | Use mouse wheel/buttons on chart, verify visible candle range changes.                                                                                                    |
| FR09  | `ChartDisplay` shall allow zooming using the zoom buttons (+/-).                                                                          | `ChartDisplay.jsx`, `InteractiveTradingPreview.jsx`    | Use zoom buttons, verify chart scale changes.                                                                                                                             |
| FR10  | `ChartDisplay` shall display current price, and if a position is open, its type, entry price, size, leverage, margin, PNL, and liq. price. | `ChartDisplay.jsx`                                     | Open a position, verify info bar shows all required details accurately.                                                                                                   |
| FR11  | `ChartDisplay` shall render dashed lines for entry price and liquidation price on the chart when a position is open.                      | `ChartDisplay.jsx`                                     | Open a position, verify lines appear at correct price levels.                                                                                                             |
| FR12  | `TradingPanel` shall display the current wallet balance as non-editable "Position Size".                                                  | `TradingPanel.jsx`                                     | View panel, verify Position Size matches wallet balance.                                                                                                                  |
| FR13  | `TradingPanel` shall provide a leverage slider (1x-1000x) that updates the `leverage` state.                                              | `TradingPanel.jsx`, `InteractiveTradingPreview.jsx`    | Adjust slider, verify leverage value changes in state/UI.                                                                                                                 |
| FR14  | The leverage slider shall be disabled when a position is open (`position !== null`).                                                      | `TradingPanel.jsx`                                     | Open a position, verify leverage slider is disabled. Close position, verify it's enabled.                                                                                 |
| FR15  | `TradingPanel` shall display the trader's heart rate (BPM) with an animated ECG visual.                                                   | `TradingPanel.jsx`                                     | Observe Trader Status, verify BPM value and animation are present.                                                                                                        |
| FR16  | `TradingPanel` shall display the trader's emotion via a dynamically updated emoji based on game state (PNL, leverage).                    | `TradingPanel.jsx`, `InteractiveTradingPreview.jsx`    | Observe Trader Status during different PNL situations, verify emoji changes appropriately.                                                                                |
| FR17  | `TradingActions` shall display the current leverage setting, total trade count, and total session PNL.                                    | `TradingActions.jsx`                                   | Observe actions footer, verify displayed values are correct.                                                                                                              |
| FR18  | Clicking "BUY/LONG" shall open a long position if none is open, using current price as entry and full wallet balance as size.             | `TradingActions.jsx`, `InteractiveTradingPreview.jsx`  | Click "BUY/LONG" when no position open, verify position state updates (type='buy', entryPrice set), info bar updates.                                                    |
| FR19  | Clicking "SELL/SHORT" shall open a short position if none is open, using current price as entry and full wallet balance as size.            | `TradingActions.jsx`, `InteractiveTradingPreview.jsx` | Click "SELL/SHORT" when no position open, verify position state updates (type='sell', entryPrice set), info bar updates.                                                   |
| FR20  | The "BUY/LONG" button shall be disabled if a long position is already open.                                                               | `TradingActions.jsx`                                   | Open a long position, verify "BUY/LONG" button is disabled.                                                                                                               |
| FR21  | The "SELL/SHORT" button shall be disabled if a short position is already open.                                                            | `TradingActions.jsx`                                   | Open a short position, verify "SELL/SHORT" button is disabled.                                                                                                            |
| FR22  | Clicking "CLOSE" shall close the currently open position, record the trade, and update total PNL and wallet balance.                      | `TradingActions.jsx`, `InteractiveTradingPreview.jsx`  | Open a position, click "CLOSE", verify position state resets, trade appears in history, wallet balance reflects final PNL.                                                |
| FR23  | The "CLOSE" button shall be disabled if no position is open.                                                                              | `TradingActions.jsx`                                   | Ensure no position is open, verify "CLOSE" button is disabled.                                                                                                            |
| FR24  | Real-time PNL shall be calculated correctly based on position type, entry price, current price, leverage, and entry wallet balance.       | `InteractiveTradingPreview.jsx`                        | Open a position, manually calculate expected PNL based on price movement, verify displayed PNL matches calculation.                                                       |
| FR25  | Wallet balance displayed in the header shall update dynamically based on the real-time PNL of the open position.                          | `GameHeader.jsx`, `InteractiveTradingPreview.jsx`      | Open a position, observe wallet balance fluctuating with price changes.                                                                                                   |
| FR26  | Liquidation shall occur, transitioning state to `GAME_OVER`, if `Current PNL <= -Wallet Balance at Entry`.                                | `InteractiveTradingPreview.jsx`                        | Enter a high-leverage trade, let price move significantly against it, verify game ends with "LIQUIDATED!" message when loss threshold is met.                               |
| FR27  | Upon liquidation, the wallet balance shall be set to $0.                                                                                  | `InteractiveTradingPreview.jsx`, `GameOver.jsx`        | Trigger liquidation, verify Game Over screen shows $0 final balance.                                                                                                      |
| FR28  | The game timer shall count down from 120 seconds during the `TRADING` state.                                                              | `InteractiveTradingPreview.jsx`, `GameHeader.jsx`      | Start trading phase, observe timer in header counting down.                                                                                                               |
| FR29  | When the timer reaches 0, the state shall transition to `GAME_OVER`. Any open position is closed.                                         | `InteractiveTradingPreview.jsx`                        | Let timer run out, verify game ends with "TIME'S UP!" message. Verify open position (if any) is closed and PNL calculated.                                               |
| FR30  | The Game Over screen shall display the correct title ("LIQUIDATED!" or "TIME'S UP!"), final balance, and total PNL.                       | `GameOver.jsx`                                         | Reach game over via time and liquidation, verify correct title and summary stats are shown.                                                                               |
| FR31  | If liquidated, the Game Over screen shall display details of the liquidated trade (Type, Entry, Liq. Price, Leverage).                   | `GameOver.jsx`                                         | Trigger liquidation, verify details box is shown with correct information.                                                                                                |
| FR32  | The Game Over screen shall display a scrollable table of trades made during the session (Type, PNL).                                      | `GameOver.jsx`                                         | Complete several trades, reach game over, verify trade history table shows all trades correctly.                                                                          |
| FR33  | Clicking "PLAY AGAIN" on the Game Over screen shall reset game state (wallet, PNL, history, timer, etc.) and return to `CHARACTER_SELECT`. | `GameOver.jsx`, `App.jsx`, `InteractiveTradingPreview.jsx` | Click "PLAY AGAIN", verify Character Select screen appears and starting a new game has fresh state ($10k wallet, 0 PNL, etc.).                                            |
| FR34  | Animation overlays shall trigger appropriately: green flash for profit close, red flash for loss close, screen shake/red flash for liq.   | `AnimationOverlays.jsx`, `InteractiveTradingPreview.jsx` | Close trades with profit/loss, trigger liquidation, verify corresponding visual effects occur briefly.                                                                    |

## 4. Non-Functional Requirements

*   **NFR01 (Performance):** Chart updates should occur smoothly (approx. 1 per second) without noticeable lag or stuttering on target devices. UI interactions (button clicks, slider adjustments) should feel responsive.
*   **NFR02 (Usability):** All interactive elements should provide clear visual feedback (hover states, disabled states). Key information (Price, PNL, Balance, Time) must be easily readable. Controls should be intuitive. The game viewport should scale correctly to different screen sizes.
*   **NFR03 (Visuals):** The application must maintain a consistent retro pixel art style across all screens and components as defined in the GDD. Text must be legible. Color coding (green for positive/long, red for negative/short/warning) must be used consistently.

## 5. Future Considerations (Optional - Out of Scope for MVP)

*   Implementing sound effects and background music.
*   Adding more character types with unique gameplay modifiers (e.g., starting balance, sanity decay rate).
*   Introducing different tradable assets with distinct volatility patterns.
*   Adding a tutorial or help screen explaining the mechanics.
*   Implementing a persistent leaderboard or high score system.
*   Refining chart panning/dragging interactions.